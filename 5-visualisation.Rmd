---
title: "Visualisation des données"
description: | 
  Cette section présente les données contenues dans le jeu de données. Elle 
  permet notamment de prendre connaissance des statistiques relatives aux 
  différentes variables d'intérêt et de visualiser leur distribution.
date: "`r Sys.Date()`"
# Modifier les détails que vous voulez
author:
  - first_name: "Stéphanie"
    last_name: "Lapierre"
    url: https://github.com/stephanielapierre
    # les champs d'affiliation sont optionnels, vous pouvez les
    # comment out en ajoutant un # devant.
    # affiliation: FAS1002
    # affiliation_url: https://admission.umontreal.ca/programmes/microprogramme-de-1er-cycle-en-analyse-des-megadonnees-en-sciences-humaines-et-sociales/structure-du-programme/
    # changer pour votre propre orcid id
    # https://orcid.org/ pour vous inscrire.
    # orcid_id: 0000-0000-0000-0000
# Changer pour votre propre URL si jamais quelqu'un vous cite!
citation_url: https://fas1002.github.io/FAS1002_projet-final
# Inclure les références que vous utilisez dans vos rapports
# dans un fichier biblio.bib. Je conseille Zotero pour construire
# ce fichier ou d'utiliser le package citr dans RStudio.
# Installation: devtools::install_github("crsh/citr")
bibliography: references.bib
output: distill::distill_article
---

```{r setup, include=FALSE}
source("R/opening-processed-data-2.R", local = knitr::knit_global())              # Script pour l'ouverture des données traitées
knitr::opts_chunk$set(echo = FALSE)
```

```{r, include=FALSE}
library(tidyverse)
library(lubridate)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(kableExtra)
```

# Idées pour la visualisation


- Carte du monde avec les clusters

- Nuage de point interactif avec l'ensemble de cluster

- Puis un prend un seul cluster et les couleurs deviennent les continents

- Puis on change l'espérance de vie par le pib par habitant


- Graphique interactif (comme l'exemple, on présente l'évolution de la vaccination dans le temps)









## Évolution de la vaccination dans le temps

Enfin, voici un graphique qui présente l'évolution dans le temps de la proportion de personnes pleinement vaccinées (par 100 habitants) en relation avec l'espérance de vie.
```{r plotly}
library(plotly)

timeline <- filter(df, df$region == "pays")

fig <- timeline %>%
  plot_ly(
    x = ~ people_fully_vaccinated_per_hundred,
    y = ~ life_expectancy,
    size = ~ gdp,
    color = ~ continent,
    frame = ~ date,
    text = ~ name,
    hoverinfo = "text",
    type = 'scatter',
    mode = 'markers',
    width = "100%",
    height = 600
  )

#fig <- fig %>% layout(xaxis = list(type = "log"))

#fig <- fig %>%
#  animation_button(
#    x = 0, xanchor = "left", y = -0.15, yanchor = "bottom"
#  )

fig
```




















```{r, include=FALSE}
ggplot(df_pays, 
      aes(people_fully_vaccinated_per_hundred, income_per_person, col=continent)) + 
      geom_point() + 
      ggtitle("Relation entre les personnes pleinement vaccinées par 100 hab. et du PIB par hab.") +
      theme_economist() +
      theme(legend.position = "top", legend.direction = "horizontal",
        legend.box = "horizontal",
        legend.key.size = unit(0.6, "cm"),
        plot.title = element_text(family="Tahoma", size = 14),
        text = element_text(family = "Tahoma"),
        axis.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.title= element_blank())
```


```{r, include=FALSE}
ggplot(df_pays, 
      aes(people_fully_vaccinated_per_hundred, life_expectancy, col=continent)) + 
      geom_point() + 
      ggtitle("Relation entre les personnes pleinement vaccinées par 100 hab. et l'espérance de vie") +
      theme_economist() +
      theme(legend.position = "top", legend.direction = "horizontal",
        legend.box = "horizontal",
        legend.key.size = unit(0.6, "cm"),
        plot.title = element_text(family="Tahoma", size = 14),
        text = element_text(family = "Tahoma"),
        axis.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.title= element_blank())
```


```{r, include=FALSE}
ggplot(df_pays, 
      aes(people_fully_vaccinated_per_hundred, growth_gdp_per_capita, col=continent)) + 
      geom_point() + 
      ggtitle("Relation entre les personnes pleinement vaccinées par 100 hab. et la croissance du PIB par hab.") +
      theme_economist() +
      theme(legend.position = "top", legend.direction = "horizontal",
        legend.box = "horizontal",
        legend.key.size = unit(0.6, "cm"),
        plot.title = element_text(family="Tahoma", size = 14),
        text = element_text(family = "Tahoma"),
        axis.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.title= element_blank())
```



## Un peu d'interactivité pour le plaisir!

```{r map, layout = "l-page"}
library(leaflet)
leaflet() %>%
  addTiles() %>%
  addMarkers(lng=174.768, lat=-36.852, popup="Là où R est né") %>%
  addProviderTiles(providers$Stamen.Watercolor)
```


## Peut-être que ça vous inspirera!

```{r plotly}
library(plotly)
library(gapminder)
df <- gapminder

fig <- df %>%
  plot_ly(
    x = ~ gdpPercap,
    y = ~ lifeExp,
    size = ~ pop,
    color = ~ continent,
    frame = ~ year,
    text = ~ country,
    hoverinfo = "text",
    type = 'scatter',
    mode = 'markers',
    width = "100%",
    height = 600
  )

fig <- fig %>% layout(xaxis = list(type = "log"))

fig <- fig %>%
  animation_button(
    x = 0, xanchor = "left", y = -0.15, yanchor = "bottom"
  )

fig
```


