---
title: "Importation des données"
description: | 
  Cette section a pour objectif de présenter les données utilisées dans ce rapport ainsi que leur source.
date: "`r Sys.Date()`"
# Modifier les détails que vous voulez
author:
  - first_name: "Stéphanie"
    last_name: "Lapierre"
    url: https://github.com/stephanielapierre
    # les champs d'affiliation sont optionnels, vous pouvez les
    # comment out en ajoutant un # devant.
    affiliation: FAS1002
    affiliation_url: https://admission.umontreal.ca/programmes/microprogramme-de-1er-cycle-en-analyse-des-megadonnees-en-sciences-humaines-et-sociales/structure-du-programme/
    # changer pour votre propre orcid id
    # https://orcid.org/ pour vous inscrire.
    # orcid_id: 0000-0000-0000-0000
# Changer pour votre propre URL si jamais quelqu'un vous cite!
citation_url: https://fas1002.github.io/FAS1002_projet-final
# Inclure les références que vous utilisez dans vos rapports
# dans un fichier biblio.bib. Je conseille Zotero pour construire
# ce fichier ou d'utiliser le package citr dans RStudio.
# Installation: devtools::install_github("crsh/citr")
bibliography: references.bib
output: distill::distill_article
---

```{r setup, include=FALSE}
source("R/data-download.R", local = knitr::knit_global())             # Script pour le téléchargement des données
knitr::opts_chunk$set(echo = FALSE)
```

```{r, include=FALSE}
library(tidyverse)
library(readxl)
library(dplyr)
```

Vous pouvez maintenant importer et travailler sur vos données, comme celles de @mathieu2021.


### Différents niveaux de titres

Dans vos différents documents, assurez-vous de bien utiliser la notation avec du Markdown et autres. 


### Appeler les données de Our World in Data

```{r}
vac_file <- list.files("data/raw/", pattern ="vaccination")
df_vaccination <- read.csv(paste0("data/raw/", vac_file))
df_vaccination <- as_tibble(df_vaccination)
rm(vac_file)

df_vaccination$location <- as.factor(df_vaccination$location)
df_vaccination$iso_code <- as.factor(df_vaccination$iso_code)
df_vaccination$date <- as.Date(df_vaccination$date)

summary(df_vaccination)
```

La variable `location` contient autant des pays que des régions. Afin de pouvoir distinguer les pays des régions, il faut ajouter une nouvelle variable. 

```{r}
df_vaccination$type_location <- str_detect(df_vaccination$iso_code, "OWID_")
df_vaccination$type_location <- str_replace(df_vaccination$type_location, "TRUE", "region")
df_vaccination$type_location <- str_replace(df_vaccination$type_location, "FALSE", "country")
df_vaccination$type_location <- as.factor(df_vaccination$type_location)
```


### Ouvrir les données de GapMinder

Population
```{r}
# Population
pop_file <- list.files("data/raw/", pattern ="population")
df_pop_regions <- read_excel(paste0("data/raw/", pop_file), sheet = "data-for-regions-by-year")
df_pop_country <- read_excel(paste0("data/raw/", pop_file), sheet = "data-for-countries-etc-by-year")
df_pop_regions <- as_tibble(df_pop_regions)
df_pop_country <- as_tibble(df_pop_country)
rm(pop_file)

df_pop_country$geo <- as.factor(df_pop_country$geo)
df_pop_country$name <- as.factor(df_pop_country$name)
df_pop_regions$geo <- as.factor(df_pop_regions$geo)
df_pop_regions$name <- as.factor(df_pop_regions$name)
```


Produit intérieur brut (PIB)
```{r}
# PIB
pib_file <- list.files("data/raw/", pattern ="pib")
df_pib_regions <- read_excel(paste0("data/raw/", pib_file), sheet = "data-for-regions-by-year")
df_pib_country <- read_excel(paste0("data/raw/", pib_file), sheet = "data-for-countries-etc-by-year")
df_pib_regions <- as_tibble(df_pib_regions)
df_pib_country <- as_tibble(df_pib_country)
rm(pib_file)

df_pib_country$geo <- as.factor(df_pib_country$geo)
df_pib_country$name <- as.factor(df_pib_country$name)
df_pib_regions$geo <- as.factor(df_pib_regions$geo)
df_pib_regions$name <- as.factor(df_pib_regions$name)
```

Espérance de vie
```{r}
# Life expectancy
life_file <- list.files("data/raw/", pattern ="life-expectancy")
df_life.exp_regions <- read_excel(paste0("data/raw/", life_file), sheet = "data-for-regions-by-year")
df_life.exp_country <- read_excel(paste0("data/raw/", life_file), sheet = "data-for-countries-etc-by-year")
df_life.exp_regions <- as_tibble(df_life.exp_regions)
df_life.exp_country <- as_tibble(df_life.exp_country)
rm(life_file)

df_life.exp_country$geo <- as.factor(df_life.exp_country$geo)
df_life.exp_country$name <- as.factor(df_life.exp_country$name)
df_life.exp_regions$geo <- as.factor(df_life.exp_regions$geo)
df_life.exp_regions$name <- as.factor(df_life.exp_regions$name)
```
